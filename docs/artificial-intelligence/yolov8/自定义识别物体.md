# yolov8自定义识别物体

> 本文的文件夹名字命名以及格局都可以随意修改（前提是你懂整个逻辑）

## 新建一个文件夹`kinda`作为根目录

## 新建文件夹`dataset`存放标签和图片文件

## `dataset`目录下新建`image`文件夹

## `image`目录下新建`train`、`val`、`test`文件夹

> 不一定要全部建立，看个人需求

- train 训练数据
- val 验证数据
- test 测试数据

## `dataset`目录下新建`labels`文件夹

## `labels`目录下新建`train`、`val`、`test`文件夹

> 这几个文件夹后续用来存放volo格式标签数据文件。

## `kinda`目录下新建`dataset.yaml`文件

文件数据格式如下

```yaml
# Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]
path: ../datasets/coco128  # dataset root dir
train: images/train2017  # train images (relative to 'path') 128 images
val: images/train2017  # val images (relative to 'path') 128 images
test:  # test images (optional)

# Classes (80 COCO classes)
names:
  0: person
  1: bicycle
  2: car
  ...
  77: teddy bear
  78: hair drier
  79: toothbrush
```

## 创建标签

推荐图片标注工具[makesense]https://www.makesense.ai

![](https://oss.kinda.info/image/202304042012171.png)

可以批量导入图片

如果是检测物体那么选择`Object Detection`，如果是图片分类任务那么选择`Image recognition`

## 编辑标签

> 这一步可以先做，也可以随着绘制框线后续增加标签。

Edit Labels

![](https://oss.kinda.info/image/202304042014082.png)

![](https://oss.kinda.info/image/202304042015890.png)

## 绘制框线

![](https://oss.kinda.info/image/202304042017879.png)

## 选择标签

![](https://oss.kinda.info/image/202304042018532.png)

## 导出yolo格式标注文件(txt格式)

Export Annotations

![](https://oss.kinda.info/image/202304042018834.png)

具体txt文件如下

```txt
0 0.481719 0.634028 0.690625 0.713278
0 0.741094 0.524306 0.314750 0.933389
27 0.364844 0.795833 0.078125 0.400000
```

## 最终文件夹结构如下

注意: 每张图片和其对应的label文件命名必须一致。

```
.
├── dataset.yaml
└── datasets
    ├── images
    │   ├── train
    │   │   ├── 01.jpg
    │   │   ├── 02.jpg
    │   │   ├── 03.jpg
    │   │   └── 04.jpg
    │   └── val
    │       ├── 01.jpg
    │       ├── 02.jpg
    │       ├── 03.jpg
    │       └── 04.jpg
    └── labels
        ├── train
        │   ├── 01.txt
        │   ├── 02.txt
        │   ├── 03.txt
        │   └── 04.txt
        ├── train.cache
        ├── val
        │   ├── 01.txt
        │   ├── 02.txt
        │   ├── 03.txt
        │   └── 04.txt
        └── val.cache
```

## 开始训练

```python
from ultralytics import YOLO

# Create a new YOLO model from scratch
model = YOLO('yolov8n.yaml')

# Load a pretrained YOLO model (recommended for training)
model = YOLO('yolov8n.pt')  # load an official model

# Train the model using the 'dataset.yaml' dataset for 3 epochs
results = model.train(data='dataset.yaml', epochs=3)

# Evaluate the model's performance on the validation set
results = model.val()
```

## 预测

```python
# Predict with the model
results = model('https://ultralytics.com/images/bus.jpg')  # predict on an image
```
