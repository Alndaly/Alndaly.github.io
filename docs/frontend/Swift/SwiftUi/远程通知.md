## 证书模式

1. 去[Apple开发者官网](https://developer.apple.com/account/resources/identifiers/list)新建一个APP并且开启推送权限。

![](https://upload.kinda.info/image/202212151736791.png)

![](https://upload.kinda.info/image/202212151737433.png)

2. 配置本地测试证书
    1. 本地生成csr文件
       1. 打开Keychain Access
        ![](https://upload.kinda.info/image/202212151757359.png)
       2. 配置证书
       ![](https://upload.kinda.info/image/202212151758906.png)

        选择保存到本地（此时不需要上传到ca认证）
       ![](https://upload.kinda.info/image/202212151800048.png)
    2. 上传CSR文件
        ![](https://upload.kinda.info/image/202212151803306.png)
    3. 下载证书
        ![](https://upload.kinda.info/image/202212151804864.png)

3. 配置发布证书（如果需要，那么具体操作同上）
4. 双击下载下来的证书加到KeyChain Access

## Token模式

### 生成Token

[官网文档](https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/establishing_a_token-based_connection_to_apns)

1. 生成新的key

[Apple Developer](https://developer.apple.com/account/resources/authkeys/list)

![](https://upload.kinda.info/image/202212161140314.png)

![](https://upload.kinda.info/image/202212161141832.png)

2. 数据准备

KEYID

![](https://upload.kinda.info/image/202212161143310.png)

[Apple Developer账号信息](https://developer.apple.com/account)

团队ID：

![](https://upload.kinda.info/image/202212161151053.png)

|Key|Description|
|--|--|
|`alg`|编码算法，苹果目前只支持`ES256`|
|`kid`|上面记录下来的Key ID|
|`iss`|你的开发者账号的Team ID|
|`iat`|Token的生成时间（UTC时区，从Epoch以来的秒数）|

JSON示例：

```json
{
   "alg" : "ES256",
   "kid" : "ABC123DEFG"
}
{
   "iss": "DEF123GHIJ",
   "iat": 1437179036
}
```

3. JWT编码

